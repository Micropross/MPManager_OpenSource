--- Commands/RelayCommand.cs	Thu Jun 02 19:01:30 2016
+++ Commands/RelayCommand.cs	Thu Jun 02 19:01:55 2016
@@ -15,6 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows.Input;
 
 namespace Xceed.Wpf.AvalonDock.Commands
--- Controls/Shell/Standard/Debug.cs	Thu Jun 02 19:01:30 2016
+++ Controls/Shell/Standard/Debug.cs	Thu Jun 02 19:01:55 2016
@@ -380,8 +380,7 @@
         [Conditional("DEBUG")]
         public static void IsNotOnMainThread()
         {
-            if (System.Windows.Application.Current != null &&
-                System.Windows.Application.Current.Dispatcher.CheckAccess())
+            if (System.Windows.Application.Current.Dispatcher.CheckAccess())
             {
                 _Break();
             }
--- Controls/Shell/Standard/DoubleUtil.cs	Thu Jun 02 19:01:30 2016
+++ Controls/Shell/Standard/DoubleUtil.cs	Thu Jun 02 19:01:55 2016
@@ -17,6 +17,7 @@
 
 namespace Standard
 {
+    using System;
     using System.Diagnostics.CodeAnalysis;
 
     /// <summary>
--- Controls/Shell/Standard/DpiHelper.cs	Thu Jun 02 19:01:30 2016
+++ Controls/Shell/Standard/DpiHelper.cs	Thu Jun 02 19:01:55 2016
@@ -20,6 +20,7 @@
 
 namespace Standard
 {
+    using System;
     using System.Diagnostics.CodeAnalysis;
     using System.Windows;
     using System.Windows.Media;
--- Controls/Shell/Standard/MessageWindow.cs	Thu Jun 02 19:01:30 2016
+++ Controls/Shell/Standard/MessageWindow.cs	Thu Jun 02 19:01:55 2016
@@ -21,11 +21,11 @@
 namespace Standard
 {
     using System;
-    using System.Collections.Generic;
-    using System.Diagnostics.CodeAnalysis;
     using System.Runtime.InteropServices;
     using System.Windows;
     using System.Windows.Threading;
+    using System.Collections.Generic;
+    using System.Diagnostics.CodeAnalysis;
 
     internal sealed class MessageWindow : DispatcherObject, IDisposable
     {
--- Controls/Shell/Standard/NativeMethods.cs	Thu Jun 02 19:01:30 2016
+++ Controls/Shell/Standard/NativeMethods.cs	Thu Jun 02 19:01:55 2016
@@ -33,6 +33,8 @@
 
     // Some COM interfaces and Win32 structures are already declared in the framework.
     // Interesting ones to remember in System.Runtime.InteropServices.ComTypes are:
+    using FILETIME = System.Runtime.InteropServices.ComTypes.FILETIME;
+    using IPersistFile = System.Runtime.InteropServices.ComTypes.IPersistFile;
     using IStream = System.Runtime.InteropServices.ComTypes.IStream;
 
     #region Native Values
@@ -2997,11 +2999,19 @@
 
         [SuppressMessage("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
         [DllImport("gdiplus.dll")]
+        public static extern Status GdipCreateHBITMAPFromBitmap(IntPtr bitmap, out IntPtr hbmReturn, Int32 background);
+
+        [SuppressMessage("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
+        [DllImport("gdiplus.dll")]
         public static extern Status GdipCreateHICONFromBitmap(IntPtr bitmap, out IntPtr hbmReturn);
 
         [SuppressMessage("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
         [DllImport("gdiplus.dll")]
         public static extern Status GdipDisposeImage(IntPtr image);
+
+        [SuppressMessage("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
+        [DllImport("gdiplus.dll")]
+        public static extern Status GdipImageForceValidation(IntPtr image);
 
         [SuppressMessage("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
         [DllImport("gdiplus.dll")]
--- Controls/Shell/Standard/Utilities.cs	Thu Jun 02 19:01:30 2016
+++ Controls/Shell/Standard/Utilities.cs	Thu Jun 02 19:01:55 2016
@@ -23,9 +23,6 @@
 // they're not particular to any library functionality.
 // Because the classes here are internal, it's likely this file
 // might be included in multiple assemblies.
-
-using System.IO;
-
 namespace Standard
 {
     using System;
@@ -33,7 +30,7 @@
     using System.ComponentModel;
     using System.Diagnostics.CodeAnalysis;
     using System.Globalization;
-    using Alphaleonis.Win32.Filesystem;
+    using System.IO;
     using System.Reflection;
     using System.Runtime.InteropServices;
     using System.Security.Cryptography;
--- Controls/Shell/Standard/Verify.cs	Thu Jun 02 19:01:30 2016
+++ Controls/Shell/Standard/Verify.cs	Thu Jun 02 19:01:55 2016
@@ -29,7 +29,7 @@
     using System.Diagnostics;
     using System.Diagnostics.CodeAnalysis;
     using System.Globalization;
-    using Alphaleonis.Win32.Filesystem;
+    using System.IO;
     using System.Threading;
 
     /// <summary>
--- Controls/Shell/SystemParameters2.cs	Thu Jun 02 19:01:30 2016
+++ Controls/Shell/SystemParameters2.cs	Thu Jun 02 19:01:55 2016
@@ -18,8 +18,6 @@
     Copyright Microsoft Corporation. All Rights Reserved.
 \**************************************************************************/
 
-using Alphaleonis.Win32.Filesystem;
-
 namespace Microsoft.Windows.Shell
 {
     using System;
@@ -246,7 +244,7 @@
             NativeMethods.GetCurrentThemeName(out name, out color, out size);
 
             // Consider whether this is the most useful way to expose this...
-            UxThemeName = Path.GetFileNameWithoutExtension(name);
+            UxThemeName = System.IO.Path.GetFileNameWithoutExtension(name);
             UxThemeColor = color;
         }
 
--- Controls/Shell/WindowChromeWorker.cs	Thu Jun 02 19:01:30 2016
+++ Controls/Shell/WindowChromeWorker.cs	Thu Jun 02 19:01:55 2016
@@ -24,13 +24,15 @@
     using System.Collections.Generic;
     using System.Diagnostics.CodeAnalysis;
     using System.Runtime.InteropServices;
+    using System.Threading;
     using System.Windows;
-    using System.Windows.Controls.Primitives;
     using System.Windows.Interop;
     using System.Windows.Media;
     using System.Windows.Threading;
     using Standard;
+
     using HANDLE_MESSAGE = System.Collections.Generic.KeyValuePair<Standard.WM, Standard.MessageHandler>;
+    using System.Windows.Controls.Primitives;
 
     internal class WindowChromeWorker : DependencyObject
     {
--- Controls/AnchorablePaneControlOverlayArea.cs	Thu Jun 02 19:01:30 2016
+++ Controls/AnchorablePaneControlOverlayArea.cs	Thu Jun 02 19:01:55 2016
@@ -14,7 +14,12 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
+using Xceed.Wpf.AvalonDock.Layout;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/AnchorablePaneDropTarget.cs	Thu Jun 02 19:01:30 2016
+++ Controls/AnchorablePaneDropTarget.cs	Thu Jun 02 19:01:55 2016
@@ -14,7 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
 using System.Linq;
+using System.Text;
 using System.Windows;
 using System.Windows.Media;
 using Xceed.Wpf.AvalonDock.Layout;
--- Controls/AnchorablePaneTabPanel.cs	Thu Jun 02 19:01:30 2016
+++ Controls/AnchorablePaneTabPanel.cs	Thu Jun 02 19:01:55 2016
@@ -15,9 +15,11 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
 using System.Linq;
-using System.Windows;
+using System.Text;
 using System.Windows.Controls;
+using System.Windows;
 using Xceed.Wpf.AvalonDock.Layout;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/AnchorablePaneTitle.cs	Thu Jun 02 19:01:30 2016
+++ Controls/AnchorablePaneTitle.cs	Thu Jun 02 19:01:55 2016
@@ -14,9 +14,12 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
 using System.Linq;
-using System.Windows;
+using System.Text;
 using System.Windows.Controls;
+using System.Windows;
 using System.Windows.Input;
 using Xceed.Wpf.AvalonDock.Layout;
 
@@ -67,7 +70,7 @@
         /// </summary>
         protected virtual void OnModelChanged(DependencyPropertyChangedEventArgs e)
         {
-            if (Model != null && Model.Root != null && Model.Root.Manager != null)
+            if (Model != null)
                 SetLayoutItem(Model.Root.Manager.GetLayoutItemFromModel(Model));
             else
                 SetLayoutItem(null);
--- Controls/AutoHideWindowManager.cs	Thu Jun 02 19:01:30 2016
+++ Controls/AutoHideWindowManager.cs	Thu Jun 02 19:01:55 2016
@@ -15,6 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows.Threading;
 using Xceed.Wpf.AvalonDock.Layout;
 
--- Controls/BindingHelper.cs	Thu Jun 02 19:01:30 2016
+++ Controls/BindingHelper.cs	Thu Jun 02 19:01:55 2016
@@ -15,8 +15,11 @@
   **********************************************************************/
 
 using System;
-using System.ComponentModel;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
+using System.ComponentModel;
 using System.Windows.Data;
 using System.Windows.Threading;
 
--- Controls/ContextMenuEx.cs	Thu Jun 02 19:01:30 2016
+++ Controls/ContextMenuEx.cs	Thu Jun 02 19:01:55 2016
@@ -14,8 +14,13 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows.Controls;
 using System.Windows.Data;
+using System.Windows;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/DockingManagerDropTarget.cs	Thu Jun 02 19:01:30 2016
+++ Controls/DockingManagerDropTarget.cs	Thu Jun 02 19:01:55 2016
@@ -15,7 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
 using System.Linq;
+using System.Text;
 using System.Windows;
 using System.Windows.Media;
 using Xceed.Wpf.AvalonDock.Layout;
--- Controls/DockingManagerOverlayArea.cs	Thu Jun 02 19:01:30 2016
+++ Controls/DockingManagerOverlayArea.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/DocumentPaneControlOverlayArea.cs	Thu Jun 02 19:01:30 2016
+++ Controls/DocumentPaneControlOverlayArea.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/DocumentPaneDropAsAnchorableTarget.cs	Thu Jun 02 19:01:30 2016
+++ Controls/DocumentPaneDropAsAnchorableTarget.cs	Thu Jun 02 19:01:55 2016
@@ -15,9 +15,12 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
 using System.Linq;
+using System.Text;
 using System.Windows;
 using System.Windows.Media;
+using System.Diagnostics;
 using Xceed.Wpf.AvalonDock.Layout;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/DocumentPaneDropTarget.cs	Thu Jun 02 19:01:30 2016
+++ Controls/DocumentPaneDropTarget.cs	Thu Jun 02 19:01:55 2016
@@ -14,9 +14,13 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
 using System.Linq;
+using System.Text;
 using System.Windows;
 using System.Windows.Media;
+using System.Diagnostics;
 using Xceed.Wpf.AvalonDock.Layout;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/DocumentPaneGroupDropTarget.cs	Thu Jun 02 19:01:30 2016
+++ Controls/DocumentPaneGroupDropTarget.cs	Thu Jun 02 19:01:55 2016
@@ -14,9 +14,13 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
 using System.Linq;
+using System.Text;
 using System.Windows;
 using System.Windows.Media;
+using System.Diagnostics;
 using Xceed.Wpf.AvalonDock.Layout;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/DocumentPaneTabPanel.cs	Thu Jun 02 19:01:30 2016
+++ Controls/DocumentPaneTabPanel.cs	Thu Jun 02 19:01:55 2016
@@ -15,9 +15,11 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
 using System.Linq;
-using System.Windows;
+using System.Text;
 using System.Windows.Controls;
+using System.Windows;
 using Xceed.Wpf.AvalonDock.Layout;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/DragService.cs	Thu Jun 02 19:01:30 2016
+++ Controls/DragService.cs	Thu Jun 02 19:01:55 2016
@@ -14,9 +14,13 @@
 
   **********************************************************************/
 
+using System;
 using System.Collections.Generic;
 using System.Linq;
+using System.Text;
+using System.Windows.Input;
 using System.Windows;
+using System.Diagnostics;
 using Xceed.Wpf.AvalonDock.Layout;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/DropArea.cs	Thu Jun 02 19:01:30 2016
+++ Controls/DropArea.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/DropDownButton.cs	Thu Jun 02 19:01:30 2016
+++ Controls/DropDownButton.cs	Thu Jun 02 19:01:55 2016
@@ -14,9 +14,15 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
+using System.Windows.Controls.Primitives;
 using System.Windows;
 using System.Windows.Controls;
-using System.Windows.Controls.Primitives;
+using System.Windows.Data;
+using System.Diagnostics;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/DropDownControlArea.cs	Thu Jun 02 19:01:30 2016
+++ Controls/DropDownControlArea.cs	Thu Jun 02 19:01:55 2016
@@ -14,9 +14,16 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
 using System.Windows.Controls;
 using System.Windows.Controls.Primitives;
+using System.Windows.Media;
+using System.Windows.Input;
+using System.Diagnostics;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/DropTarget.cs	Thu Jun 02 19:01:30 2016
+++ Controls/DropTarget.cs	Thu Jun 02 19:01:55 2016
@@ -17,10 +17,11 @@
 using System;
 using System.Collections.Generic;
 using System.Linq;
+using System.Text;
 using System.Windows;
 using System.Windows.Media;
-using System.Windows.Threading;
 using Xceed.Wpf.AvalonDock.Layout;
+using System.Windows.Threading;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/DropTargetBase.cs	Thu Jun 02 19:01:30 2016
+++ Controls/DropTargetBase.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/DropTargetType.cs	Thu Jun 02 19:01:30 2016
+++ Controls/DropTargetType.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/Extentions.cs	Thu Jun 02 19:01:30 2016
+++ Controls/Extentions.cs	Thu Jun 02 19:01:55 2016
@@ -14,11 +14,14 @@
 
   **********************************************************************/
 
+using System;
 using System.Collections.Generic;
 using System.Linq;
+using System.Text;
 using System.Windows;
 using System.Windows.Media;
 using System.Windows.Media.Media3D;
+using System.Runtime.InteropServices;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/FocusElementManager.cs	Thu Jun 02 19:01:30 2016
+++ Controls/FocusElementManager.cs	Thu Jun 02 19:01:55 2016
@@ -16,14 +16,15 @@
 
 using System;
 using System.Collections.Generic;
-using System.Diagnostics;
 using System.Linq;
-using System.Windows;
+using System.Text;
 using System.Windows.Input;
 using System.Windows.Interop;
+using System.Windows;
+using System.Diagnostics;
+using Xceed.Wpf.AvalonDock.Layout;
 using System.Windows.Media;
 using System.Windows.Threading;
-using Xceed.Wpf.AvalonDock.Layout;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
@@ -72,8 +73,7 @@
 
         private static void Current_Exit(object sender, ExitEventArgs e)
         {
-            if (Application.Current != null)
-                Application.Current.Exit -= new ExitEventHandler(Current_Exit);
+            Application.Current.Exit -= new ExitEventHandler(Current_Exit);
             if (_windowHandler != null)
             {
                 _windowHandler.FocusChanged -= new EventHandler<FocusChangeEventArgs>(WindowFocusChanging);
--- Controls/FullWeakDictionary.cs	Thu Jun 02 19:01:30 2016
+++ Controls/FullWeakDictionary.cs	Thu Jun 02 19:01:55 2016
@@ -16,6 +16,8 @@
 
 using System;
 using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/IDropTarget.cs	Thu Jun 02 19:01:30 2016
+++ Controls/IDropTarget.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
 using System.Windows.Media;
 using Xceed.Wpf.AvalonDock.Layout;
--- Controls/IOverlayWindow.cs	Thu Jun 02 19:01:30 2016
+++ Controls/IOverlayWindow.cs	Thu Jun 02 19:01:55 2016
@@ -14,7 +14,10 @@
 
   **********************************************************************/
 
+using System;
 using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/IOverlayWindowArea.cs	Thu Jun 02 19:01:30 2016
+++ Controls/IOverlayWindowArea.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/IOverlayWindowDropTarget.cs	Thu Jun 02 19:01:30 2016
+++ Controls/IOverlayWindowDropTarget.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/IOverlayWindowHost.cs	Thu Jun 02 19:01:30 2016
+++ Controls/IOverlayWindowHost.cs	Thu Jun 02 19:01:55 2016
@@ -14,7 +14,10 @@
 
   **********************************************************************/
 
+using System;
 using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/LayoutAnchorableControl.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutAnchorableControl.cs	Thu Jun 02 19:01:55 2016
@@ -14,8 +14,19 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
 using System.Windows.Controls;
+using System.Windows.Data;
+using System.Windows.Documents;
+using System.Windows.Input;
+using System.Windows.Media;
+using System.Windows.Media.Imaging;
+using System.Windows.Navigation;
+using System.Windows.Shapes;
 using Xceed.Wpf.AvalonDock.Layout;
 
 namespace Xceed.Wpf.AvalonDock.Controls
@@ -67,7 +78,7 @@
         /// </summary>
         protected virtual void OnModelChanged(DependencyPropertyChangedEventArgs e)
         {
-            if (Model != null && Model.Root != null && Model.Root.Manager != null)
+            if (Model != null)
                 SetLayoutItem(Model.Root.Manager.GetLayoutItemFromModel(Model));
             else
                 SetLayoutItem(null);
--- Controls/LayoutAnchorableFloatingWindowControl.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutAnchorableFloatingWindowControl.cs	Thu Jun 02 19:01:55 2016
@@ -17,14 +17,20 @@
 using System;
 using System.Collections.Generic;
 using System.Linq;
+using System.Text;
 using System.Windows;
-using System.Windows.Controls.Primitives;
+using System.Runtime.InteropServices;
+using System.Windows.Interop;
+using System.Windows.Controls;
 using System.Windows.Data;
+using System.Windows.Media;
 using System.Windows.Input;
-using Microsoft.Windows.Shell;
-using Xceed.Wpf.AvalonDock.Commands;
-using Xceed.Wpf.AvalonDock.Converters;
 using Xceed.Wpf.AvalonDock.Layout;
+using Xceed.Wpf.AvalonDock.Converters;
+using System.Diagnostics;
+using System.Windows.Controls.Primitives;
+using Xceed.Wpf.AvalonDock.Commands;
+using Microsoft.Windows.Shell;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/LayoutAnchorableItem.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutAnchorableItem.cs	Thu Jun 02 19:01:55 2016
@@ -15,11 +15,14 @@
   **********************************************************************/
 
 using System;
-using System.Windows;
-using System.Windows.Data;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
+using Xceed.Wpf.AvalonDock.Layout;
 using System.Windows.Input;
+using System.Windows;
 using Xceed.Wpf.AvalonDock.Commands;
-using Xceed.Wpf.AvalonDock.Layout;
+using System.Windows.Data;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/LayoutAnchorablePaneControl.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutAnchorablePaneControl.cs	Thu Jun 02 19:01:55 2016
@@ -15,8 +15,12 @@
   **********************************************************************/
 
 using System;
-using System.Windows;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
+using System.Collections.ObjectModel;
 using System.Windows.Controls;
+using System.Windows;
 using System.Windows.Data;
 using Xceed.Wpf.AvalonDock.Layout;
 
--- Controls/LayoutAnchorablePaneGroupControl.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutAnchorablePaneGroupControl.cs	Thu Jun 02 19:01:56 2016
@@ -14,8 +14,12 @@
 
   **********************************************************************/
 
-using System.Windows;
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows.Controls;
+using System.Windows;
 using Xceed.Wpf.AvalonDock.Layout;
 
 
--- Controls/LayoutAnchorableTabItem.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutAnchorableTabItem.cs	Thu Jun 02 19:01:56 2016
@@ -14,11 +14,17 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
 using System.Linq;
+using System.Text;
 using System.Windows;
+using System.Collections.ObjectModel;
 using System.Windows.Controls;
 using System.Windows.Input;
 using Xceed.Wpf.AvalonDock.Layout;
+using System.Reflection;
+using System.Diagnostics;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
@@ -68,7 +74,7 @@
         /// </summary>
         protected virtual void OnModelChanged(DependencyPropertyChangedEventArgs e)
         {
-            if (Model != null && Model.Root != null && Model.Root.Manager != null)
+            if (Model != null)
                 SetLayoutItem(Model.Root.Manager.GetLayoutItemFromModel(Model));
             else
                 SetLayoutItem(null);
--- Controls/LayoutAnchorControl.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutAnchorControl.cs	Thu Jun 02 19:01:56 2016
@@ -15,10 +15,13 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
 using System.Windows.Controls;
-using System.Windows.Threading;
 using Xceed.Wpf.AvalonDock.Layout;
+using System.Windows.Threading;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
@@ -128,7 +131,7 @@
             _openUpTimer.Tick -= new EventHandler(_openUpTimer_Tick);
             _openUpTimer.Stop();
             _openUpTimer = null;
-           // _model.Root.Manager.ShowAutoHideWindow(this);
+            _model.Root.Manager.ShowAutoHideWindow(this);
         }
 
         protected override void OnMouseLeave(System.Windows.Input.MouseEventArgs e)
--- Controls/LayoutAnchorGroupControl.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutAnchorGroupControl.cs	Thu Jun 02 19:01:56 2016
@@ -14,11 +14,14 @@
 
   **********************************************************************/
 
-using System.Collections.ObjectModel;
+using System;
+using System.Collections.Generic;
 using System.Linq;
-using System.Windows;
+using System.Text;
 using System.Windows.Controls;
+using System.Collections.ObjectModel;
 using Xceed.Wpf.AvalonDock.Layout;
+using System.Windows;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/LayoutAnchorSideControl.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutAnchorSideControl.cs	Thu Jun 02 19:01:56 2016
@@ -15,10 +15,12 @@
   **********************************************************************/
 
 using System;
-using System.Collections.ObjectModel;
+using System.Collections.Generic;
 using System.Linq;
-using System.Windows;
+using System.Text;
 using System.Windows.Controls;
+using System.Windows;
+using System.Collections.ObjectModel;
 using Xceed.Wpf.AvalonDock.Layout;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/LayoutAutoHideWindowControl.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutAutoHideWindowControl.cs	Thu Jun 02 19:01:56 2016
@@ -15,16 +15,19 @@
   **********************************************************************/
 
 using System;
-using System.Diagnostics;
+using System.Collections.Generic;
 using System.Linq;
+using System.Text;
+using System.Windows.Interop;
+using System.Windows.Controls;
 using System.Runtime.InteropServices;
 using System.Windows;
-using System.Windows.Controls;
-using System.Windows.Data;
 using System.Windows.Input;
-using System.Windows.Interop;
+using System.Windows.Data;
 using System.Windows.Media;
 using Xceed.Wpf.AvalonDock.Layout;
+using System.Diagnostics;
+using System.Windows.Threading;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
@@ -49,17 +52,15 @@
 
             _anchor = anchor;
             _model = anchor.Model as LayoutAnchorable;
-            _model.ToggleAutoHide();            
+            _side = (anchor.Model.Parent.Parent as LayoutAnchorSide).Side;
             _manager = _model.Root.Manager;
-            //CreateInternalGrid();
+            CreateInternalGrid();
 
-/*
             _model.PropertyChanged += new System.ComponentModel.PropertyChangedEventHandler(_model_PropertyChanged);
 
             Visibility = System.Windows.Visibility.Visible;
             InvalidateMeasure();
             UpdateWindowPos();
-*/
             Trace.WriteLine("LayoutAutoHideWindowControl.Show()");
         }
 
@@ -250,8 +251,6 @@
 
         void RemoveInternalGrid()
         {
-            if (_resizer == null)
-                return;
             _resizer.DragStarted -= new System.Windows.Controls.Primitives.DragStartedEventHandler(OnResizerDragStarted);
             _resizer.DragDelta -= new System.Windows.Controls.Primitives.DragDeltaEventHandler(OnResizerDragDelta);
             _resizer.DragCompleted -= new System.Windows.Controls.Primitives.DragCompletedEventHandler(OnResizerDragCompleted);
--- Controls/LayoutDocumentControl.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutDocumentControl.cs	Thu Jun 02 19:01:56 2016
@@ -14,8 +14,19 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
 using System.Windows.Controls;
+using System.Windows.Data;
+using System.Windows.Documents;
+using System.Windows.Input;
+using System.Windows.Media;
+using System.Windows.Media.Imaging;
+using System.Windows.Navigation;
+using System.Windows.Shapes;
 using Xceed.Wpf.AvalonDock.Layout;
 
 namespace Xceed.Wpf.AvalonDock.Controls
@@ -68,7 +79,7 @@
         /// </summary>
         protected virtual void OnModelChanged(DependencyPropertyChangedEventArgs e)
         {
-            if (Model != null && Model.Root != null && Model.Root.Manager != null)
+            if (Model != null)
                 SetLayoutItem(Model.Root.Manager.GetLayoutItemFromModel(Model));
             else
                 SetLayoutItem(null);
--- Controls/LayoutDocumentFloatingWindowControl.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutDocumentFloatingWindowControl.cs	Thu Jun 02 19:01:56 2016
@@ -15,10 +15,15 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
+using System.Windows.Data;
+using Xceed.Wpf.AvalonDock.Layout;
 using System.Windows;
 using System.Windows.Controls.Primitives;
+using System.Windows.Media;
 using Microsoft.Windows.Shell;
-using Xceed.Wpf.AvalonDock.Layout;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/LayoutDocumentItem.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutDocumentItem.cs	Thu Jun 02 19:01:56 2016
@@ -14,8 +14,12 @@
 
   **********************************************************************/
 
-using System.Windows;
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using Xceed.Wpf.AvalonDock.Layout;
+using System.Windows;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/LayoutDocumentPaneControl.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutDocumentPaneControl.cs	Thu Jun 02 19:01:56 2016
@@ -16,7 +16,10 @@
 
 using System;
 using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
+using System.Collections.ObjectModel;
 using System.Windows.Controls;
 using System.Windows.Data;
 using Xceed.Wpf.AvalonDock.Layout;
--- Controls/LayoutDocumentPaneGroupControl.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutDocumentPaneGroupControl.cs	Thu Jun 02 19:01:56 2016
@@ -14,8 +14,12 @@
 
   **********************************************************************/
 
-using System.Windows;
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows.Controls;
+using System.Windows;
 using Xceed.Wpf.AvalonDock.Layout;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/LayoutDocumentTabItem.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutDocumentTabItem.cs	Thu Jun 02 19:01:56 2016
@@ -17,10 +17,13 @@
 using System;
 using System.Collections.Generic;
 using System.Linq;
+using System.Text;
 using System.Windows;
 using System.Windows.Controls;
 using System.Windows.Input;
 using Xceed.Wpf.AvalonDock.Layout;
+using System.Diagnostics;
+using System.Windows.Media;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
@@ -69,7 +72,7 @@
         /// </summary>
         protected virtual void OnModelChanged(DependencyPropertyChangedEventArgs e)
         {
-            if (Model != null && Model.Root != null && Model.Root.Manager != null)
+            if (Model != null)
                 SetLayoutItem(Model.Root.Manager.GetLayoutItemFromModel(Model));
             else
                 SetLayoutItem(null);
--- Controls/LayoutFloatingWindowControl.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutFloatingWindowControl.cs	Thu Jun 02 19:01:56 2016
@@ -15,17 +15,19 @@
   **********************************************************************/
 
 using System;
-using System.Diagnostics;
+using System.Collections.Generic;
 using System.Linq;
-using System.Runtime.InteropServices;
+using System.Text;
 using System.Windows;
+using System.Runtime.InteropServices;
+using System.Windows.Interop;
+using System.Windows.Input;
 using System.Windows.Controls;
 using System.Windows.Data;
-using System.Windows.Documents;
-using System.Windows.Input;
-using System.Windows.Interop;
 using System.Windows.Media;
 using Xceed.Wpf.AvalonDock.Layout;
+using System.Diagnostics;
+using System.Windows.Documents;
 using Xceed.Wpf.AvalonDock.Themes;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/LayoutGridControl.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutGridControl.cs	Thu Jun 02 19:01:56 2016
@@ -15,13 +15,16 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
 using System.Linq;
-using System.Windows;
+using System.Text;
 using System.Windows.Controls;
+using System.Windows;
 using System.Windows.Input;
 using System.Windows.Media;
-using System.Windows.Threading;
 using Xceed.Wpf.AvalonDock.Layout;
+using System.Diagnostics;
+using System.Windows.Threading;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/LayoutGridResizerControl.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutGridResizerControl.cs	Thu Jun 02 19:01:56 2016
@@ -14,8 +14,12 @@
 
   **********************************************************************/
 
-using System.Windows;
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows.Controls.Primitives;
+using System.Windows;
 using System.Windows.Media;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/LayoutItem.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutItem.cs	Thu Jun 02 19:01:56 2016
@@ -15,14 +15,17 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
 using System.Linq;
+using System.Text;
 using System.Windows;
-using System.Windows.Controls;
-using System.Windows.Data;
+using Xceed.Wpf.AvalonDock.Layout;
 using System.Windows.Input;
-using System.Windows.Media;
 using Xceed.Wpf.AvalonDock.Commands;
-using Xceed.Wpf.AvalonDock.Layout;
+using System.ComponentModel;
+using System.Windows.Data;
+using System.Windows.Media;
+using System.Windows.Controls;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/LayoutPanelControl.cs	Thu Jun 02 19:01:30 2016
+++ Controls/LayoutPanelControl.cs	Thu Jun 02 19:01:56 2016
@@ -15,8 +15,11 @@
   **********************************************************************/
 
 using System;
-using System.Windows;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows.Controls;
+using System.Windows;
 using Xceed.Wpf.AvalonDock.Layout;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/MenuItemEx.cs	Thu Jun 02 19:01:30 2016
+++ Controls/MenuItemEx.cs	Thu Jun 02 19:01:56 2016
@@ -14,8 +14,12 @@
 
   **********************************************************************/
 
-using System.Windows;
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows.Controls;
+using System.Windows;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/NavigatorWindow.cs	Thu Jun 02 19:01:30 2016
+++ Controls/NavigatorWindow.cs	Thu Jun 02 19:01:56 2016
@@ -14,10 +14,14 @@
 
   **********************************************************************/
 
+using System;
 using System.Collections.Generic;
 using System.Linq;
+using System.Text;
 using System.Windows;
 using Xceed.Wpf.AvalonDock.Layout;
+using System.Windows.Interop;
+using System.Windows.Threading;
 using Xceed.Wpf.AvalonDock.Themes;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/OverlayArea.cs	Thu Jun 02 19:01:30 2016
+++ Controls/OverlayArea.cs	Thu Jun 02 19:01:56 2016
@@ -14,7 +14,13 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
+using System.Windows.Controls;
 using System.Windows;
+using Xceed.Wpf.AvalonDock.Layout;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/OverlayWindow.cs	Thu Jun 02 19:01:30 2016
+++ Controls/OverlayWindow.cs	Thu Jun 02 19:01:56 2016
@@ -14,12 +14,16 @@
 
   **********************************************************************/
 
+using System;
 using System.Collections.Generic;
 using System.Linq;
+using System.Text;
 using System.Windows;
 using System.Windows.Controls;
+using System.Windows.Media;
 using System.Windows.Shapes;
 using Xceed.Wpf.AvalonDock.Layout;
+using System.Diagnostics;
 using Xceed.Wpf.AvalonDock.Themes;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/OverlayWindowDropTarget.cs	Thu Jun 02 19:01:30 2016
+++ Controls/OverlayWindowDropTarget.cs	Thu Jun 02 19:01:56 2016
@@ -14,6 +14,11 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
+using System.Windows.Controls;
 using System.Windows;
 
 namespace Xceed.Wpf.AvalonDock.Controls
--- Controls/OverlayWindowDropTargetType.cs	Thu Jun 02 19:01:30 2016
+++ Controls/OverlayWindowDropTargetType.cs	Thu Jun 02 19:01:56 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/ReentrantFlag.cs	Thu Jun 02 19:01:30 2016
+++ Controls/ReentrantFlag.cs	Thu Jun 02 19:01:56 2016
@@ -15,6 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/TransformExtentions.cs	Thu Jun 02 19:01:30 2016
+++ Controls/TransformExtentions.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
 using System.Windows.Media;
 
--- Controls/WeakDictionary.cs	Thu Jun 02 19:01:30 2016
+++ Controls/WeakDictionary.cs	Thu Jun 02 19:01:55 2016
@@ -16,6 +16,8 @@
 
 using System;
 using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/WindowActivateEventArgs.cs	Thu Jun 02 19:01:30 2016
+++ Controls/WindowActivateEventArgs.cs	Thu Jun 02 19:01:55 2016
@@ -15,6 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Controls/WindowHookHandler.cs	Thu Jun 02 19:01:30 2016
+++ Controls/WindowHookHandler.cs	Thu Jun 02 19:01:55 2016
@@ -15,6 +15,10 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
+using System.Threading;
 
 namespace Xceed.Wpf.AvalonDock.Controls
 {
--- Converters/ActivateCommandLayoutItemFromLayoutModelConverter.cs	Thu Jun 02 19:01:31 2016
+++ Converters/ActivateCommandLayoutItemFromLayoutModelConverter.cs	Thu Jun 02 19:01:55 2016
@@ -15,6 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows.Data;
 using Xceed.Wpf.AvalonDock.Layout;
 
--- Converters/AnchorSideToAngleConverter.cs	Thu Jun 02 19:01:31 2016
+++ Converters/AnchorSideToAngleConverter.cs	Thu Jun 02 19:01:55 2016
@@ -15,6 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows.Data;
 using Xceed.Wpf.AvalonDock.Layout;
 
--- Converters/AnchorSideToOrientationConverter.cs	Thu Jun 02 19:01:31 2016
+++ Converters/AnchorSideToOrientationConverter.cs	Thu Jun 02 19:01:55 2016
@@ -15,8 +15,11 @@
   **********************************************************************/
 
 using System;
-using System.Windows.Controls;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows.Data;
+using System.Windows.Controls;
 using Xceed.Wpf.AvalonDock.Layout;
 
 namespace Xceed.Wpf.AvalonDock.Converters
--- Converters/AutoHideCommandLayoutItemFromLayoutModelConverter.cs	Thu Jun 02 19:01:31 2016
+++ Converters/AutoHideCommandLayoutItemFromLayoutModelConverter.cs	Thu Jun 02 19:01:55 2016
@@ -15,9 +15,12 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows.Data;
-using Xceed.Wpf.AvalonDock.Controls;
 using Xceed.Wpf.AvalonDock.Layout;
+using Xceed.Wpf.AvalonDock.Controls;
 
 namespace Xceed.Wpf.AvalonDock.Converters
 {
--- Converters/BoolToVisibilityConverter.cs	Thu Jun 02 19:01:31 2016
+++ Converters/BoolToVisibilityConverter.cs	Thu Jun 02 19:01:55 2016
@@ -15,8 +15,11 @@
   **********************************************************************/
 
 using System;
-using System.Windows;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows.Data;
+using System.Windows;
 
 namespace Xceed.Wpf.AvalonDock.Converters
 {
--- Converters/HideCommandLayoutItemFromLayoutModelConverter.cs	Thu Jun 02 19:01:31 2016
+++ Converters/HideCommandLayoutItemFromLayoutModelConverter.cs	Thu Jun 02 19:01:55 2016
@@ -15,9 +15,12 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows.Data;
-using Xceed.Wpf.AvalonDock.Controls;
 using Xceed.Wpf.AvalonDock.Layout;
+using Xceed.Wpf.AvalonDock.Controls;
 
 namespace Xceed.Wpf.AvalonDock.Converters
 {
--- Converters/InverseBoolToVisibilityConverter.cs	Thu Jun 02 19:01:31 2016
+++ Converters/InverseBoolToVisibilityConverter.cs	Thu Jun 02 19:01:55 2016
@@ -15,8 +15,11 @@
   **********************************************************************/
 
 using System;
-using System.Windows;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows.Data;
+using System.Windows;
 
 namespace Xceed.Wpf.AvalonDock.Converters
 {
--- Converters/LayoutItemFromLayoutModelConverter.cs	Thu Jun 02 19:01:31 2016
+++ Converters/LayoutItemFromLayoutModelConverter.cs	Thu Jun 02 19:01:55 2016
@@ -15,6 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows.Data;
 using Xceed.Wpf.AvalonDock.Layout;
 
--- Converters/NullToDoNothingConverter.cs	Thu Jun 02 19:01:31 2016
+++ Converters/NullToDoNothingConverter.cs	Thu Jun 02 19:01:55 2016
@@ -15,6 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows.Data;
 
 namespace Xceed.Wpf.AvalonDock.Converters
--- Converters/UriSourceToBitmapImageConverter.cs	Thu Jun 02 19:01:31 2016
+++ Converters/UriSourceToBitmapImageConverter.cs	Thu Jun 02 19:01:55 2016
@@ -15,9 +15,12 @@
   **********************************************************************/
 
 using System;
-using System.Windows.Controls;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows.Data;
 using System.Windows.Media.Imaging;
+using System.Windows.Controls;
 
 namespace Xceed.Wpf.AvalonDock.Converters
 {
--- Layout/Serialization/LayoutSerializationCallbackEventArgs.cs	Thu Jun 02 19:01:30 2016
+++ Layout/Serialization/LayoutSerializationCallbackEventArgs.cs	Thu Jun 02 19:01:56 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.ComponentModel;
 
 namespace Xceed.Wpf.AvalonDock.Layout.Serialization
--- Layout/Serialization/LayoutSerializer.cs	Thu Jun 02 19:01:30 2016
+++ Layout/Serialization/LayoutSerializer.cs	Thu Jun 02 19:01:56 2016
@@ -15,7 +15,12 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
 using System.Linq;
+using System.Text;
+using System.IO;
+using Xceed.Wpf.AvalonDock.Controls;
+using System.Windows;
 
 namespace Xceed.Wpf.AvalonDock.Layout.Serialization
 {
--- Layout/Serialization/XmlLayoutSerializer.cs	Thu Jun 02 19:01:30 2016
+++ Layout/Serialization/XmlLayoutSerializer.cs	Thu Jun 02 19:01:56 2016
@@ -14,9 +14,12 @@
 
   **********************************************************************/
 
-using System.IO;
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Xml.Serialization;
-using File = Alphaleonis.Win32.Filesystem.File;
+using System.IO;
 
 namespace Xceed.Wpf.AvalonDock.Layout.Serialization
 {
@@ -33,12 +36,12 @@
             var serializer = new XmlSerializer(typeof(LayoutRoot));
             serializer.Serialize(writer, Manager.Layout);
         }
-        public void Serialize(TextWriter writer)
+        public void Serialize(System.IO.TextWriter writer)
         {
             var serializer = new XmlSerializer(typeof(LayoutRoot));
             serializer.Serialize(writer, Manager.Layout);
         }
-        public void Serialize(Stream stream)
+        public void Serialize(System.IO.Stream stream)
         {
             var serializer = new XmlSerializer(typeof(LayoutRoot));
             serializer.Serialize(stream, Manager.Layout);
@@ -46,14 +49,11 @@
 
         public void Serialize(string filepath)
         {
-            using (FileStream fs = File.Open(filepath.Replace('/', Path.DirectorySeparatorChar), FileMode.Create))
-            {
-                using (var stream = new StreamWriter(fs))
-                    Serialize(stream);
-            }
+            using (var stream = new StreamWriter(filepath))
+                Serialize(stream);
         }
 
-        public void Deserialize(Stream stream)
+        public void Deserialize(System.IO.Stream stream)
         {
             try
             {
@@ -62,8 +62,6 @@
                 var layout = serializer.Deserialize(stream) as LayoutRoot;
                 FixupLayout(layout);
                 Manager.Layout = layout;
-                if (layout != null && layout.Manager == null)
-                    layout.Manager = Manager;
             }
             finally
             {
@@ -71,7 +69,7 @@
             }
         }
 
-        public void Deserialize(TextReader reader)
+        public void Deserialize(System.IO.TextReader reader)
         {
             try
             {
@@ -105,48 +103,8 @@
 
         public void Deserialize(string filepath)
         {
-            using (FileStream fs = File.Open(filepath.Replace('/', Path.DirectorySeparatorChar), FileMode.Open))
-            {
-                using (var stream = new StreamReader(fs))
-                    Deserialize(stream);
-            }
-        }
-
-
-        public static void SerializeLayout(string targetFile, DockingManager dockingManager)
-        {
-            var serializer = new XmlLayoutSerializer(dockingManager);
-            using (FileStream stream = File.Open(targetFile, FileMode.OpenOrCreate, FileAccess.Write))
-            {
-                serializer.Serialize(stream);
-            }
-        }
-
-        public static void DeserializeLayout(string targetFile, DockingManager dockingManager)
-        {
-            var serializer = new XmlLayoutSerializer(dockingManager);
-
-            using (FileStream stream = File.Open(targetFile, FileMode.Open, FileAccess.Read))
-            {
-                serializer.Deserialize(stream);
-            }
-        }
-
-        public static void DeleteLayout(string targetFile)
-        {
-            if (File.Exists(targetFile))
-            {
-                try
-                {
-                    File.Delete(targetFile);
-                }
-                catch
-                {
-                    //Probleme de droits
-                }
-             
-            }
+            using (var stream = new StreamReader(filepath))
+                Deserialize(stream);
         }
-
     }
 }
--- Layout/AnchorableShowStrategy.cs	Thu Jun 02 19:01:30 2016
+++ Layout/AnchorableShowStrategy.cs	Thu Jun 02 19:01:55 2016
@@ -15,6 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/AnchorSide.cs	Thu Jun 02 19:01:30 2016
+++ Layout/AnchorSide.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/ChildrenTreeChangedEventArgs.cs	Thu Jun 02 19:01:30 2016
+++ Layout/ChildrenTreeChangedEventArgs.cs	Thu Jun 02 19:01:55 2016
@@ -15,6 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/Extentions.cs	Thu Jun 02 19:01:30 2016
+++ Layout/Extentions.cs	Thu Jun 02 19:01:55 2016
@@ -14,7 +14,13 @@
 
   **********************************************************************/
 
+using System;
 using System.Collections.Generic;
+using System.Linq;
+using System.Text;
+using System.Windows;
+using System.Windows.Media;
+using System.Windows.Media.Media3D;
 using System.Diagnostics;
 using System.Runtime.InteropServices;
 
--- Layout/ILayoutAnchorablePane.cs	Thu Jun 02 19:01:30 2016
+++ Layout/ILayoutAnchorablePane.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/ILayoutContainer.cs	Thu Jun 02 19:01:30 2016
+++ Layout/ILayoutContainer.cs	Thu Jun 02 19:01:55 2016
@@ -14,7 +14,10 @@
 
   **********************************************************************/
 
+using System;
 using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/ILayoutContentSelector.cs	Thu Jun 02 19:01:30 2016
+++ Layout/ILayoutContentSelector.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/ILayoutControl.cs	Thu Jun 02 19:01:30 2016
+++ Layout/ILayoutControl.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/ILayoutDocumentPane.cs	Thu Jun 02 19:01:30 2016
+++ Layout/ILayoutDocumentPane.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/ILayoutElement.cs	Thu Jun 02 19:01:30 2016
+++ Layout/ILayoutElement.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.ComponentModel;
 
 namespace Xceed.Wpf.AvalonDock.Layout
--- Layout/ILayoutElementWithVisibility.cs	Thu Jun 02 19:01:30 2016
+++ Layout/ILayoutElementWithVisibility.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/ILayoutGroup.cs	Thu Jun 02 19:01:30 2016
+++ Layout/ILayoutGroup.cs	Thu Jun 02 19:01:55 2016
@@ -15,6 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/ILayoutOrientableElement.cs	Thu Jun 02 19:01:30 2016
+++ Layout/ILayoutOrientableElement.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows.Controls;
 
 namespace Xceed.Wpf.AvalonDock.Layout
--- Layout/ILayoutPane.cs	Thu Jun 02 19:01:30 2016
+++ Layout/ILayoutPane.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/ILayoutPanelElement.cs	Thu Jun 02 19:01:30 2016
+++ Layout/ILayoutPanelElement.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,11 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
+using System.Windows;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/ILayoutPaneSerializable.cs	Thu Jun 02 19:01:30 2016
+++ Layout/ILayoutPaneSerializable.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/ILayoutPositionableElement.cs	Thu Jun 02 19:01:30 2016
+++ Layout/ILayoutPositionableElement.cs	Thu Jun 02 19:01:56 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
 
 namespace Xceed.Wpf.AvalonDock.Layout
--- Layout/ILayoutPreviousContainer.cs	Thu Jun 02 19:01:30 2016
+++ Layout/ILayoutPreviousContainer.cs	Thu Jun 02 19:01:56 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/ILayoutRoot.cs	Thu Jun 02 19:01:30 2016
+++ Layout/ILayoutRoot.cs	Thu Jun 02 19:01:56 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Collections.ObjectModel;
 
 namespace Xceed.Wpf.AvalonDock.Layout
--- Layout/ILayoutUpdateStrategy.cs	Thu Jun 02 19:01:30 2016
+++ Layout/ILayoutUpdateStrategy.cs	Thu Jun 02 19:01:56 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/LayoutAnchorable.cs	Thu Jun 02 19:01:30 2016
+++ Layout/LayoutAnchorable.cs	Thu Jun 02 19:01:56 2016
@@ -15,12 +15,14 @@
   **********************************************************************/
 
 using System;
-using System.ComponentModel;
-using System.Globalization;
+using System.Collections.Generic;
 using System.Linq;
+using System.Text;
 using System.Windows;
-using System.Windows.Controls;
 using System.Xml.Serialization;
+using System.Windows.Controls;
+using System.Globalization;
+using System.ComponentModel;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/LayoutAnchorableFloatingWindow.cs	Thu Jun 02 19:01:30 2016
+++ Layout/LayoutAnchorableFloatingWindow.cs	Thu Jun 02 19:01:56 2016
@@ -16,9 +16,10 @@
 
 using System;
 using System.Collections.Generic;
-using System.Diagnostics;
 using System.Linq;
+using System.Text;
 using System.Windows.Markup;
+using System.Diagnostics;
 using System.Xml.Serialization;
 
 namespace Xceed.Wpf.AvalonDock.Layout
--- Layout/LayoutAnchorablePane.cs	Thu Jun 02 19:01:30 2016
+++ Layout/LayoutAnchorablePane.cs	Thu Jun 02 19:01:56 2016
@@ -15,8 +15,12 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
 using System.Linq;
+using System.Text;
+using System.Collections.ObjectModel;
 using System.Windows.Markup;
+using System.ComponentModel;
 using System.Xml.Serialization;
 
 namespace Xceed.Wpf.AvalonDock.Layout
--- Layout/LayoutAnchorablePaneGroup.cs	Thu Jun 02 19:01:30 2016
+++ Layout/LayoutAnchorablePaneGroup.cs	Thu Jun 02 19:01:56 2016
@@ -15,7 +15,11 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
 using System.Linq;
+using System.Text;
+using System.Collections.ObjectModel;
+using System.Windows;
 using System.Windows.Controls;
 using System.Windows.Markup;
 
--- Layout/LayoutAnchorGroup.cs	Thu Jun 02 19:01:30 2016
+++ Layout/LayoutAnchorGroup.cs	Thu Jun 02 19:01:56 2016
@@ -15,6 +15,10 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
+using System.Collections.ObjectModel;
 using System.Windows.Markup;
 using System.Xml.Serialization;
 
--- Layout/LayoutAnchorSide.cs	Thu Jun 02 19:01:30 2016
+++ Layout/LayoutAnchorSide.cs	Thu Jun 02 19:01:56 2016
@@ -15,7 +15,12 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
+using System.Collections.ObjectModel;
 using System.Windows.Markup;
+using Xceed.Wpf.AvalonDock.Controls;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/LayoutContent.cs	Thu Jun 02 19:01:30 2016
+++ Layout/LayoutContent.cs	Thu Jun 02 19:01:56 2016
@@ -15,13 +15,15 @@
   **********************************************************************/
 
 using System;
-using System.ComponentModel;
-using System.Globalization;
+using System.Collections.Generic;
 using System.Linq;
-using System.Windows;
+using System.Text;
 using System.Windows.Markup;
-using System.Windows.Media;
 using System.Xml.Serialization;
+using System.Windows;
+using System.Globalization;
+using System.Windows.Media;
+using System.ComponentModel;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
@@ -340,8 +342,8 @@
         public void Close()
         {
             var root = Root;
-            if(Parent != null)
-                Parent.RemoveChild(this);
+            var parentAsContainer = Parent as ILayoutContainer;
+            parentAsContainer.RemoveChild(this);
             if (root != null)
                 root.CollectGarbage();
 
--- Layout/LayoutDocument.cs	Thu Jun 02 19:01:30 2016
+++ Layout/LayoutDocument.cs	Thu Jun 02 19:01:56 2016
@@ -15,7 +15,10 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
 using System.Linq;
+using System.Text;
+using System.Globalization;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/LayoutDocumentFloatingWindow.cs	Thu Jun 02 19:01:30 2016
+++ Layout/LayoutDocumentFloatingWindow.cs	Thu Jun 02 19:01:55 2016
@@ -16,8 +16,10 @@
 
 using System;
 using System.Collections.Generic;
-using System.Diagnostics;
+using System.Linq;
+using System.Text;
 using System.Windows.Markup;
+using System.Diagnostics;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/LayoutDocumentPane.cs	Thu Jun 02 19:01:30 2016
+++ Layout/LayoutDocumentPane.cs	Thu Jun 02 19:01:55 2016
@@ -17,6 +17,8 @@
 using System;
 using System.Collections.Generic;
 using System.Linq;
+using System.Text;
+using System.Collections.ObjectModel;
 using System.Windows.Markup;
 
 namespace Xceed.Wpf.AvalonDock.Layout
@@ -154,19 +156,11 @@
             }
         }
 
-        public String PaneName
-        {
-            get; set;
-        }
-
         public override void WriteXml(System.Xml.XmlWriter writer)
         {
             if (_id != null)
                 writer.WriteAttributeString("Id", _id);
 
-            if(PaneName != null)
-                writer.WriteAttributeString("PaneName", PaneName);
-
             base.WriteXml(writer);
         }
 
@@ -174,8 +168,7 @@
         {
             if (reader.MoveToAttribute("Id"))
                 _id = reader.Value;
-            if (reader.MoveToAttribute("PaneName"))
-                PaneName = reader.Value;
+
 
             base.ReadXml(reader);
         }
--- Layout/LayoutDocumentPaneGroup.cs	Thu Jun 02 19:01:30 2016
+++ Layout/LayoutDocumentPaneGroup.cs	Thu Jun 02 19:01:55 2016
@@ -15,6 +15,11 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
+using System.Collections.ObjectModel;
+using System.Windows;
 using System.Windows.Controls;
 using System.Windows.Markup;
 
--- Layout/LayoutElement.cs	Thu Jun 02 19:01:30 2016
+++ Layout/LayoutElement.cs	Thu Jun 02 19:01:55 2016
@@ -15,8 +15,11 @@
   **********************************************************************/
 
 using System;
-using System.ComponentModel;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
+using System.ComponentModel;
 using System.Xml.Serialization;
 
 namespace Xceed.Wpf.AvalonDock.Layout
--- Layout/LayoutElementEventArgs.cs	Thu Jun 02 19:01:30 2016
+++ Layout/LayoutElementEventArgs.cs	Thu Jun 02 19:01:55 2016
@@ -15,6 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/LayoutFloatingWindow.cs	Thu Jun 02 19:01:30 2016
+++ Layout/LayoutFloatingWindow.cs	Thu Jun 02 19:01:55 2016
@@ -16,6 +16,10 @@
 
 using System;
 using System.Collections.Generic;
+using System.Linq;
+using System.Text;
+using System.Windows.Markup;
+using System.Windows;
 using System.Xml.Serialization;
 
 namespace Xceed.Wpf.AvalonDock.Layout
--- Layout/LayoutGroup.cs	Thu Jun 02 19:01:30 2016
+++ Layout/LayoutGroup.cs	Thu Jun 02 19:01:55 2016
@@ -16,8 +16,9 @@
 
 using System;
 using System.Collections.Generic;
-using System.Collections.ObjectModel;
 using System.Linq;
+using System.Text;
+using System.Collections.ObjectModel;
 using System.Xml.Serialization;
 
 namespace Xceed.Wpf.AvalonDock.Layout
--- Layout/LayoutGroupBase.cs	Thu Jun 02 19:01:30 2016
+++ Layout/LayoutGroupBase.cs	Thu Jun 02 19:01:55 2016
@@ -15,6 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Xml.Serialization;
 
 namespace Xceed.Wpf.AvalonDock.Layout
--- Layout/LayoutPanel.cs	Thu Jun 02 19:01:30 2016
+++ Layout/LayoutPanel.cs	Thu Jun 02 19:01:55 2016
@@ -15,9 +15,13 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
 using System.Linq;
-using System.Windows.Controls;
+using System.Text;
 using System.Windows.Markup;
+using System.Collections.ObjectModel;
+using System.Windows;
+using System.Windows.Controls;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/LayoutPositionableGroup.cs	Thu Jun 02 19:01:30 2016
+++ Layout/LayoutPositionableGroup.cs	Thu Jun 02 19:01:55 2016
@@ -15,8 +15,11 @@
   **********************************************************************/
 
 using System;
-using System.Globalization;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
+using System.Globalization;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Layout/LayoutRoot.cs	Thu Jun 02 19:01:30 2016
+++ Layout/LayoutRoot.cs	Thu Jun 02 19:01:55 2016
@@ -16,10 +16,13 @@
 
 using System;
 using System.Collections.Generic;
-using System.Collections.ObjectModel;
 using System.Linq;
+using System.Text;
+using System.Windows;
+using System.Collections.ObjectModel;
 using System.Windows.Markup;
 using System.Xml.Serialization;
+using Standard;
 
 namespace Xceed.Wpf.AvalonDock.Layout
 {
--- Properties/AssemblyInfo.cs	Thu Jun 02 19:01:31 2016
+++ Properties/AssemblyInfo.cs	Thu Jun 02 19:01:56 2016
@@ -14,11 +14,13 @@
 
   **********************************************************************/
 
-using System;
 using System.Reflection;
+using System.Resources;
+using System.Runtime.CompilerServices;
 using System.Runtime.InteropServices;
 using System.Windows;
 using System.Windows.Markup;
+using System;
 
 // General Information about an assembly is controlled through the following 
 // set of attributes. Change these attribute values to modify the information
@@ -72,5 +74,3 @@
 #pragma warning restore 1699
 
 
-[assembly: AssemblyVersionAttribute("3.0.0.0")]
-[assembly: AssemblyFileVersionAttribute("3.0.0.0")]
--- Properties/Resources.de.Designer.cs	Thu Jun 02 19:01:31 2016
+++ Properties/Resources.de.Designer.cs	Thu Jun 02 19:01:56 2016
@@ -0,0 +1,16 @@
+/************************************************************************
+
+   AvalonDock
+
+   Copyright (C) 2007-2013 Xceed Software Inc.
+
+   This program is provided to you under the terms of the New BSD
+   License (BSD) as published at http://avalondock.codeplex.com/license 
+
+   For more features, controls, and fast professional support,
+   pick up AvalonDock in Extended WPF Toolkit Plus at http://xceed.com/wpf_toolkit
+
+   Stay informed: follow @datagrid on Twitter or Like facebook.com/datagrids
+
+  **********************************************************************/
+
--- Properties/Resources.Designer.cs	Thu Jun 02 19:01:31 2016
+++ Properties/Resources.Designer.cs	Thu Jun 02 19:01:56 2016
@@ -1,15 +1,31 @@
+/************************************************************************
+
+   AvalonDock
+
+   Copyright (C) 2007-2013 Xceed Software Inc.
+
+   This program is provided to you under the terms of the New BSD
+   License (BSD) as published at http://avalondock.codeplex.com/license 
+
+   For more features, controls, and fast professional support,
+   pick up AvalonDock in Extended WPF Toolkit Plus at http://xceed.com/wpf_toolkit
+
+   Stay informed: follow @datagrid on Twitter or Like facebook.com/datagrids
+
+  **********************************************************************/
+
 //------------------------------------------------------------------------------
 // <auto-generated>
 //     This code was generated by a tool.
-//     Runtime Version:4.0.30319.18331
+//     Runtime Version:4.0.30319.296
 //
 //     Changes to this file may cause incorrect behavior and will be lost if
 //     the code is regenerated.
 // </auto-generated>
 //------------------------------------------------------------------------------
 
-namespace Xceed.Wpf.AvalonDock.Properties
-{
+namespace Xceed.Wpf.AvalonDock.Properties {
+    using System;
 
 
     /// <summary>
@@ -23,15 +39,15 @@
     [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
     [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
     public class Resources {
-        
+
         private static global::System.Resources.ResourceManager resourceMan;
-        
+
         private static global::System.Globalization.CultureInfo resourceCulture;
-        
+
         [global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
         internal Resources() {
         }
-        
+
         /// <summary>
         ///   Returns the cached ResourceManager instance used by this class.
         /// </summary>
@@ -45,7 +61,7 @@
                 return resourceMan;
             }
         }
-        
+
         /// <summary>
         ///   Overrides the current thread's CurrentUICulture property for all
         ///   resource lookups using this strongly typed resource class.
@@ -59,7 +75,7 @@
                 resourceCulture = value;
             }
         }
-        
+
         /// <summary>
         ///   Looks up a localized string similar to Auto Hide.
         /// </summary>
@@ -68,7 +84,7 @@
                 return ResourceManager.GetString("Anchorable_AutoHide", resourceCulture);
             }
         }
-        
+
         /// <summary>
         ///   Looks up a localized string similar to Auto Hide.
         /// </summary>
@@ -77,7 +93,7 @@
                 return ResourceManager.GetString("Anchorable_BtnAutoHide_Hint", resourceCulture);
             }
         }
-        
+
         /// <summary>
         ///   Looks up a localized string similar to Hide.
         /// </summary>
@@ -86,7 +102,7 @@
                 return ResourceManager.GetString("Anchorable_BtnClose_Hint", resourceCulture);
             }
         }
-        
+
         /// <summary>
         ///   Looks up a localized string similar to Window Position.
         /// </summary>
@@ -95,7 +111,7 @@
                 return ResourceManager.GetString("Anchorable_CxMenu_Hint", resourceCulture);
             }
         }
-        
+
         /// <summary>
         ///   Looks up a localized string similar to Dock.
         /// </summary>
@@ -104,7 +120,7 @@
                 return ResourceManager.GetString("Anchorable_Dock", resourceCulture);
             }
         }
-        
+
         /// <summary>
         ///   Looks up a localized string similar to Dock as Tabbed Document.
         /// </summary>
@@ -113,7 +129,7 @@
                 return ResourceManager.GetString("Anchorable_DockAsDocument", resourceCulture);
             }
         }
-        
+
         /// <summary>
         ///   Looks up a localized string similar to Float.
         /// </summary>
@@ -122,7 +138,7 @@
                 return ResourceManager.GetString("Anchorable_Float", resourceCulture);
             }
         }
-        
+
         /// <summary>
         ///   Looks up a localized string similar to Hide.
         /// </summary>
@@ -131,7 +147,7 @@
                 return ResourceManager.GetString("Anchorable_Hide", resourceCulture);
             }
         }
-        
+
         /// <summary>
         ///   Looks up a localized string similar to Close.
         /// </summary>
@@ -140,7 +156,7 @@
                 return ResourceManager.GetString("Document_Close", resourceCulture);
             }
         }
-        
+
         /// <summary>
         ///   Looks up a localized string similar to Close All But This.
         /// </summary>
@@ -149,7 +165,7 @@
                 return ResourceManager.GetString("Document_CloseAllButThis", resourceCulture);
             }
         }
-        
+
         /// <summary>
         ///   Looks up a localized string similar to Window Position.
         /// </summary>
@@ -158,7 +174,7 @@
                 return ResourceManager.GetString("Document_CxMenu_Hint", resourceCulture);
             }
         }
-        
+
         /// <summary>
         ///   Looks up a localized string similar to Dock as Tabbed Document.
         /// </summary>
@@ -167,7 +183,7 @@
                 return ResourceManager.GetString("Document_DockAsDocument", resourceCulture);
             }
         }
-        
+
         /// <summary>
         ///   Looks up a localized string similar to Float.
         /// </summary>
@@ -176,7 +192,7 @@
                 return ResourceManager.GetString("Document_Float", resourceCulture);
             }
         }
-        
+
         /// <summary>
         ///   Looks up a localized string similar to Move To Next Tab Group.
         /// </summary>
@@ -185,7 +201,7 @@
                 return ResourceManager.GetString("Document_MoveToNextTabGroup", resourceCulture);
             }
         }
-        
+
         /// <summary>
         ///   Looks up a localized string similar to Move To Previous Tab Group.
         /// </summary>
@@ -194,7 +210,7 @@
                 return ResourceManager.GetString("Document_MoveToPreviousTabGroup", resourceCulture);
             }
         }
-        
+
         /// <summary>
         ///   Looks up a localized string similar to New Horizontal Tab Group.
         /// </summary>
@@ -203,7 +219,7 @@
                 return ResourceManager.GetString("Document_NewHorizontalTabGroup", resourceCulture);
             }
         }
-        
+
         /// <summary>
         ///   Looks up a localized string similar to New Vertical Tab Group.
         /// </summary>
@@ -212,7 +228,7 @@
                 return ResourceManager.GetString("Document_NewVerticalTabGroup", resourceCulture);
             }
         }
-        
+
         /// <summary>
         ///   Looks up a localized string similar to Maximize.
         /// </summary>
@@ -221,7 +237,7 @@
                 return ResourceManager.GetString("Window_Maximize", resourceCulture);
             }
         }
-        
+
         /// <summary>
         ///   Looks up a localized string similar to Restore.
         /// </summary>
--- Properties/Resources.es.Designer.cs	Thu Jun 02 19:01:31 2016
+++ Properties/Resources.es.Designer.cs	Thu Jun 02 19:01:56 2016
@@ -0,0 +1,16 @@
+/************************************************************************
+
+   AvalonDock
+
+   Copyright (C) 2007-2013 Xceed Software Inc.
+
+   This program is provided to you under the terms of the New BSD
+   License (BSD) as published at http://avalondock.codeplex.com/license 
+
+   For more features, controls, and fast professional support,
+   pick up AvalonDock in Extended WPF Toolkit Plus at http://xceed.com/wpf_toolkit
+
+   Stay informed: follow @datagrid on Twitter or Like facebook.com/datagrids
+
+  **********************************************************************/
+
--- Properties/Resources.fr.Designer.cs	Thu Jun 02 19:01:31 2016
+++ Properties/Resources.fr.Designer.cs	Thu Jun 02 19:01:56 2016
@@ -0,0 +1,16 @@
+/************************************************************************
+
+   AvalonDock
+
+   Copyright (C) 2007-2013 Xceed Software Inc.
+
+   This program is provided to you under the terms of the New BSD
+   License (BSD) as published at http://avalondock.codeplex.com/license 
+
+   For more features, controls, and fast professional support,
+   pick up AvalonDock in Extended WPF Toolkit Plus at http://xceed.com/wpf_toolkit
+
+   Stay informed: follow @datagrid on Twitter or Like facebook.com/datagrids
+
+  **********************************************************************/
+
--- Properties/Resources.hu.Designer.cs	Thu Jun 02 19:01:31 2016
+++ Properties/Resources.hu.Designer.cs	Thu Jun 02 19:01:56 2016
@@ -0,0 +1,16 @@
+/************************************************************************
+
+   AvalonDock
+
+   Copyright (C) 2007-2013 Xceed Software Inc.
+
+   This program is provided to you under the terms of the New BSD
+   License (BSD) as published at http://avalondock.codeplex.com/license 
+
+   For more features, controls, and fast professional support,
+   pick up AvalonDock in Extended WPF Toolkit Plus at http://xceed.com/wpf_toolkit
+
+   Stay informed: follow @datagrid on Twitter or Like facebook.com/datagrids
+
+  **********************************************************************/
+
--- Properties/Resources.it.Designer.cs	Thu Jun 02 19:01:31 2016
+++ Properties/Resources.it.Designer.cs	Thu Jun 02 19:01:56 2016
@@ -0,0 +1,16 @@
+/************************************************************************
+
+   AvalonDock
+
+   Copyright (C) 2007-2013 Xceed Software Inc.
+
+   This program is provided to you under the terms of the New BSD
+   License (BSD) as published at http://avalondock.codeplex.com/license 
+
+   For more features, controls, and fast professional support,
+   pick up AvalonDock in Extended WPF Toolkit Plus at http://xceed.com/wpf_toolkit
+
+   Stay informed: follow @datagrid on Twitter or Like facebook.com/datagrids
+
+  **********************************************************************/
+
--- Properties/Resources.pt-BR.Designer.cs	Thu Jun 02 19:01:31 2016
+++ Properties/Resources.pt-BR.Designer.cs	Thu Jun 02 19:01:56 2016
@@ -0,0 +1,16 @@
+/************************************************************************
+
+   AvalonDock
+
+   Copyright (C) 2007-2013 Xceed Software Inc.
+
+   This program is provided to you under the terms of the New BSD
+   License (BSD) as published at http://avalondock.codeplex.com/license 
+
+   For more features, controls, and fast professional support,
+   pick up AvalonDock in Extended WPF Toolkit Plus at http://xceed.com/wpf_toolkit
+
+   Stay informed: follow @datagrid on Twitter or Like facebook.com/datagrids
+
+  **********************************************************************/
+
--- Properties/Resources.ro.Designer.cs	Thu Jun 02 19:01:31 2016
+++ Properties/Resources.ro.Designer.cs	Thu Jun 02 19:01:56 2016
@@ -0,0 +1,16 @@
+/************************************************************************
+
+   AvalonDock
+
+   Copyright (C) 2007-2013 Xceed Software Inc.
+
+   This program is provided to you under the terms of the New BSD
+   License (BSD) as published at http://avalondock.codeplex.com/license 
+
+   For more features, controls, and fast professional support,
+   pick up AvalonDock in Extended WPF Toolkit Plus at http://xceed.com/wpf_toolkit
+
+   Stay informed: follow @datagrid on Twitter or Like facebook.com/datagrids
+
+  **********************************************************************/
+
--- Properties/Resources.ru.Designer.cs	Thu Jun 02 19:01:31 2016
+++ Properties/Resources.ru.Designer.cs	Thu Jun 02 19:01:56 2016
@@ -0,0 +1,16 @@
+/************************************************************************
+
+   AvalonDock
+
+   Copyright (C) 2007-2013 Xceed Software Inc.
+
+   This program is provided to you under the terms of the New BSD
+   License (BSD) as published at http://avalondock.codeplex.com/license 
+
+   For more features, controls, and fast professional support,
+   pick up AvalonDock in Extended WPF Toolkit Plus at http://xceed.com/wpf_toolkit
+
+   Stay informed: follow @datagrid on Twitter or Like facebook.com/datagrids
+
+  **********************************************************************/
+
--- Properties/Resources.sv.Designer.cs	Thu Jun 02 19:01:31 2016
+++ Properties/Resources.sv.Designer.cs	Thu Jun 02 19:01:56 2016
@@ -0,0 +1,16 @@
+/************************************************************************
+
+   AvalonDock
+
+   Copyright (C) 2007-2013 Xceed Software Inc.
+
+   This program is provided to you under the terms of the New BSD
+   License (BSD) as published at http://avalondock.codeplex.com/license 
+
+   For more features, controls, and fast professional support,
+   pick up AvalonDock in Extended WPF Toolkit Plus at http://xceed.com/wpf_toolkit
+
+   Stay informed: follow @datagrid on Twitter or Like facebook.com/datagrids
+
+  **********************************************************************/
+
--- Properties/Resources.zh-Hans.Designer.cs	Thu Jun 02 19:01:31 2016
+++ Properties/Resources.zh-Hans.Designer.cs	Thu Jun 02 19:01:56 2016
@@ -0,0 +1,16 @@
+/************************************************************************
+
+   AvalonDock
+
+   Copyright (C) 2007-2013 Xceed Software Inc.
+
+   This program is provided to you under the terms of the New BSD
+   License (BSD) as published at http://avalondock.codeplex.com/license 
+
+   For more features, controls, and fast professional support,
+   pick up AvalonDock in Extended WPF Toolkit Plus at http://xceed.com/wpf_toolkit
+
+   Stay informed: follow @datagrid on Twitter or Like facebook.com/datagrids
+
+  **********************************************************************/
+
--- Themes/GenericTheme.cs	Thu Jun 02 19:01:31 2016
+++ Themes/GenericTheme.cs	Thu Jun 02 19:01:55 2016
@@ -15,6 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock.Themes
 {
--- Themes/Theme.cs	Thu Jun 02 19:01:31 2016
+++ Themes/Theme.cs	Thu Jun 02 19:01:55 2016
@@ -15,6 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Windows;
 
 namespace Xceed.Wpf.AvalonDock.Themes
--- AssemblyVersionInfo.cs	Thu Jun 02 19:01:30 2016
+++ AssemblyVersionInfo.cs	Thu Jun 02 19:01:55 2016
@@ -14,3 +14,19 @@
 
   **********************************************************************/
 
+#pragma warning disable 0436
+[assembly: System.Reflection.AssemblyVersion( _XceedVersionInfo.Version )]
+#pragma warning restore 0436
+
+internal static class _XceedVersionInfo
+{
+  [System.Diagnostics.CodeAnalysis.SuppressMessage( "Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields" )]
+  public const string BaseVersion = "2.0";
+  [System.Diagnostics.CodeAnalysis.SuppressMessage( "Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields" )]
+  public const string Version = BaseVersion + 
+  ".0.0";
+  [System.Diagnostics.CodeAnalysis.SuppressMessage( "Microsoft.Performance", "CA1823:AvoidUnusedPrivateFields" )]
+  public const string PublicKeyToken = "ba83ff368b7563c6";
+
+
+}
--- DockingManager.cs	Thu Jun 02 19:01:30 2016
+++ DockingManager.cs	Thu Jun 02 19:01:55 2016
@@ -15,21 +15,24 @@
   **********************************************************************/
 
 using System;
-using System.Collections;
 using System.Collections.Generic;
-using System.Collections.Specialized;
-using System.ComponentModel;
-using System.Diagnostics;
 using System.Linq;
-using System.Windows;
+using System.Text;
 using System.Windows.Controls;
-using System.Windows.Data;
-using System.Windows.Input;
-using System.Windows.Interop;
+using System.Windows;
 using System.Windows.Markup;
-using System.Windows.Threading;
-using Xceed.Wpf.AvalonDock.Controls;
+using System.ComponentModel;
+using System.Windows.Interop;
+using System.Diagnostics;
+
 using Xceed.Wpf.AvalonDock.Layout;
+using Xceed.Wpf.AvalonDock.Controls;
+using System.Windows.Input;
+using System.Collections;
+using System.Collections.Specialized;
+using System.Windows.Data;
+using System.Windows.Threading;
+using Xceed.Wpf.AvalonDock.Commands;
 using Xceed.Wpf.AvalonDock.Themes;
 
 namespace Xceed.Wpf.AvalonDock
@@ -297,7 +300,7 @@
         void DockingManager_Unloaded(object sender, RoutedEventArgs e)
         {
 
-            if (_autoHideWindowManager != null && !DesignerProperties.GetIsInDesignMode(this))
+            if (!DesignerProperties.GetIsInDesignMode(this))
             {
                 _autoHideWindowManager.HideAutoWindow();
 
--- DocumentClosedEventArgs.cs	Thu Jun 02 19:01:31 2016
+++ DocumentClosedEventArgs.cs	Thu Jun 02 19:01:55 2016
@@ -15,6 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using Xceed.Wpf.AvalonDock.Layout;
 
 namespace Xceed.Wpf.AvalonDock
--- DocumentClosingEventArgs.cs	Thu Jun 02 19:01:30 2016
+++ DocumentClosingEventArgs.cs	Thu Jun 02 19:01:55 2016
@@ -14,6 +14,10 @@
 
   **********************************************************************/
 
+using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.ComponentModel;
 using Xceed.Wpf.AvalonDock.Layout;
 
--- Extentions.cs	Thu Jun 02 19:01:30 2016
+++ Extentions.cs	Thu Jun 02 19:01:55 2016
@@ -15,8 +15,10 @@
   **********************************************************************/
 
 using System;
-using System.Collections;
 using System.Collections.Generic;
+using System.Linq;
+using System.Text;
+using System.Collections;
 
 namespace Xceed.Wpf.AvalonDock
 {
--- LayoutEventArgs.cs	Thu Jun 02 19:01:30 2016
+++ LayoutEventArgs.cs	Thu Jun 02 19:01:56 2016
@@ -15,6 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using Xceed.Wpf.AvalonDock.Layout;
 
 namespace Xceed.Wpf.AvalonDock
--- MathHelper.cs	Thu Jun 02 19:01:31 2016
+++ MathHelper.cs	Thu Jun 02 19:01:56 2016
@@ -15,6 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 
 namespace Xceed.Wpf.AvalonDock
 {
--- Win32Helper.cs	Thu Jun 02 19:01:30 2016
+++ Win32Helper.cs	Thu Jun 02 19:01:55 2016
@@ -15,6 +15,9 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
 using System.Runtime.InteropServices;
 using System.Windows;
 
--- WindowHelper.cs	Thu Jun 02 19:01:30 2016
+++ WindowHelper.cs	Thu Jun 02 19:01:56 2016
@@ -15,9 +15,12 @@
   **********************************************************************/
 
 using System;
+using System.Collections.Generic;
+using System.Linq;
+using System.Text;
+using System.Windows.Media;
 using System.Windows;
 using System.Windows.Interop;
-using System.Windows.Media;
 
 namespace Xceed.Wpf.AvalonDock
 {
--- Xceed.Wpf.AvalonDock.csproj	Thu Jun 02 19:01:30 2016
+++ Xceed.Wpf.AvalonDock.csproj	Thu Jun 02 19:01:56 2016
@@ -1,9 +1,6 @@
 <?xml version="1.0" encoding="utf-8"?>
 <Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
   <PropertyGroup>
-    <ReferencePath>C:\\dev\\software\\applications\\production\\mpmanager3\\references\\</ReferencePath>
-  </PropertyGroup>
-  <PropertyGroup>
     <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
     <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
     <ProductVersion>8.0.30703</ProductVersion>
@@ -14,8 +11,7 @@
     <RootNamespace>Xceed.Wpf.AvalonDock</RootNamespace>
     <AssemblyName>Xceed.Wpf.AvalonDock</AssemblyName>
     <TargetFrameworkVersion>v4.0</TargetFrameworkVersion>
-    <TargetFrameworkProfile>
-    </TargetFrameworkProfile>
+    <TargetFrameworkProfile>Client</TargetFrameworkProfile>
     <FileAlignment>512</FileAlignment>
     <ProjectTypeGuids>{60dc8134-eba5-43b8-bcc9-bb4bc16c2548};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
     <WarningLevel>4</WarningLevel>
@@ -24,18 +20,15 @@
     <DebugSymbols>true</DebugSymbols>
     <DebugType>full</DebugType>
     <Optimize>false</Optimize>
-    <OutputPath>..\bin\</OutputPath>
+    <OutputPath>bin\Debug\</OutputPath>
     <DefineConstants>DEBUG</DefineConstants>
     <ErrorReport>prompt</ErrorReport>
     <WarningLevel>4</WarningLevel>
-    <PlatformTarget>AnyCPU</PlatformTarget>
-    <UseVSHostingProcess>true</UseVSHostingProcess>
-    <GenerateSerializationAssemblies>On</GenerateSerializationAssemblies>
   </PropertyGroup>
   <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
     <DebugType>pdbonly</DebugType>
     <Optimize>true</Optimize>
-    <OutputPath>..\bin\</OutputPath>
+    <OutputPath>bin\Release\</OutputPath>
     <DefineConstants>TRACE</DefineConstants>
     <ErrorReport>prompt</ErrorReport>
     <WarningLevel>4</WarningLevel>
@@ -50,14 +43,13 @@
     </AssemblyOriginatorKeyFile>
   </PropertyGroup>
   <ItemGroup>
-    <Reference Include="AlphaFS2, Version=2.0.0.0, Culture=neutral, PublicKeyToken=4d31a58f7d7ad5c9, processorArchitecture=MSIL">
-      <SpecificVersion>False</SpecificVersion>
-      <HintPath>..\..\References\AlphaFS2.dll</HintPath>
-      <Private>False</Private>
-    </Reference>
     <Reference Include="System" />
+    <Reference Include="System.Data" />
     <Reference Include="System.Xml" />
+    <Reference Include="Microsoft.CSharp" />
     <Reference Include="System.Core" />
+    <Reference Include="System.Xml.Linq" />
+    <Reference Include="System.Data.DataSetExtensions" />
     <Reference Include="System.Xaml">
       <RequiredTargetFramework>4.0</RequiredTargetFramework>
     </Reference>
@@ -265,60 +257,60 @@
     <Compile Include="Themes\Theme.cs" />
     <Compile Include="Win32Helper.cs" />
     <Compile Include="WindowHelper.cs" />
-    <None Include="Properties\Resources.hu.resx">
+    <EmbeddedResource Include="Properties\Resources.hu.resx">
       <Generator>PublicResXFileCodeGenerator</Generator>
       <LastGenOutput>Resources.hu.Designer.cs</LastGenOutput>
       <SubType>Designer</SubType>
-    </None>
+    </EmbeddedResource>
     <EmbeddedResource Include="Properties\Resources.resx">
       <Generator>PublicResXFileCodeGenerator</Generator>
       <LastGenOutput>Resources.Designer.cs</LastGenOutput>
       <SubType>Designer</SubType>
     </EmbeddedResource>
-    <None Include="Properties\Resources.it.resx">
+    <EmbeddedResource Include="Properties\Resources.it.resx">
       <Generator>PublicResXFileCodeGenerator</Generator>
       <LastGenOutput>Resources.it.Designer.cs</LastGenOutput>
       <SubType>Designer</SubType>
-    </None>
-    <None Include="Properties\Resources.fr.resx">
+    </EmbeddedResource>
+    <EmbeddedResource Include="Properties\Resources.fr.resx">
       <Generator>PublicResXFileCodeGenerator</Generator>
       <LastGenOutput>Resources.fr.Designer.cs</LastGenOutput>
       <SubType>Designer</SubType>
-    </None>
-    <None Include="Properties\Resources.es.resx">
+    </EmbeddedResource>
+    <EmbeddedResource Include="Properties\Resources.es.resx">
       <Generator>PublicResXFileCodeGenerator</Generator>
       <LastGenOutput>Resources.es.Designer.cs</LastGenOutput>
-    </None>
-    <None Include="Properties\Resources.pt-BR.resx">
+    </EmbeddedResource>
+    <EmbeddedResource Include="Properties\Resources.pt-BR.resx">
       <SubType>Designer</SubType>
       <Generator>PublicResXFileCodeGenerator</Generator>
       <LastGenOutput>Resources.pt-BR.Designer.cs</LastGenOutput>
-    </None>
-    <None Include="Properties\Resources.ru.resx">
+    </EmbeddedResource>
+    <EmbeddedResource Include="Properties\Resources.ru.resx">
       <SubType>Designer</SubType>
       <Generator>PublicResXFileCodeGenerator</Generator>
       <LastGenOutput>Resources.ru.Designer.cs</LastGenOutput>
-    </None>
-    <None Include="Properties\Resources.de.resx">
+    </EmbeddedResource>
+    <EmbeddedResource Include="Properties\Resources.de.resx">
       <SubType>Designer</SubType>
       <Generator>PublicResXFileCodeGenerator</Generator>
       <LastGenOutput>Resources.de.Designer.cs</LastGenOutput>
-    </None>
-    <None Include="Properties\Resources.sv.resx">
+    </EmbeddedResource>
+    <EmbeddedResource Include="Properties\Resources.sv.resx">
       <SubType>Designer</SubType>
       <Generator>PublicResXFileCodeGenerator</Generator>
       <LastGenOutput>Resources.sv.Designer.cs</LastGenOutput>
-    </None>
-    <None Include="Properties\Resources.zh-Hans.resx">
+    </EmbeddedResource>
+    <EmbeddedResource Include="Properties\Resources.zh-Hans.resx">
       <SubType>Designer</SubType>
       <Generator>PublicResXFileCodeGenerator</Generator>
       <LastGenOutput>Resources.zh-Hans.Designer.cs</LastGenOutput>
-    </None>
-    <None Include="Properties\Resources.ro.resx">
+    </EmbeddedResource>
+    <EmbeddedResource Include="Properties\Resources.ro.resx">
       <Generator>PublicResXFileCodeGenerator</Generator>
       <LastGenOutput>Resources.ro.Designer.cs</LastGenOutput>
       <SubType>Designer</SubType>
-    </None>
+    </EmbeddedResource>
     <AppDesigner Include="Properties\" />
   </ItemGroup>
   <ItemGroup>
@@ -359,21 +351,11 @@
   </ItemGroup>
   <ItemGroup />
   <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
-  <PropertyGroup>
-    <PostBuildEvent>
-    </PostBuildEvent>
-  </PropertyGroup>
-  <Import Project="$(MSBuildExtensionsPath)\ExtensionPack\4.0\MSBuild.ExtensionPack.tasks" />
-  <Target Name="AfterBuild">
-    <ItemGroup>
-      <OutputFiles Include="$(TargetName).dll" />
-      <OutputFiles Include="$(TargetName).pdb" />
-    </ItemGroup>
-    <MSBuild.ExtensionPack.FileSystem.RoboCopy Source="$(TargetDir)\" Destination="$(TargetDir)\..\..\References" Files="@(OutputFiles)">
-      <Output TaskParameter="ExitCode" PropertyName="Exit" />
-      <Output TaskParameter="ReturnCode" PropertyName="Return" />
-    </MSBuild.ExtensionPack.FileSystem.RoboCopy>
-    <Message Text="ExitCode = $(Exit)" />
-    <Message Text="ReturnCode = $(Return)" />
-  </Target>
+  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
+       Other similar extension points exist, see Microsoft.Common.targets.
+  <Target Name="BeforeBuild">
+  </Target>
+  <Target Name="AfterBuild">
+  </Target>
+  -->
 </Project>
\ No newline at end of file
